В [[Возможности С++ для программирования работы с файлами|прошлой]] главе мы создавали программу, которая выполняла сложение пользовательской структуры данных. В С++ данная задача решается с помощью классов и механизма перегрузки операторов. Представим, что у нас есть какой-то класс `coord`:

```cpp
coord a, b, c;
```

Что произойдет, когда мы попытаемся сложить два объекта этого класса:
```cpp
c = a + b;
```

Механизм перезагрузки операторов как раз и позволяет определить, что же произойдет. В примере ниже мы перегрузили операторы + и - для класса `coord`, содержащего координаты точки в двухмерном пространстве (x и y).

```cpp
#include <iostream>

using namespace std;

class coord {
	int x, y;
public:
	coord() { x = 0, y = 0; }
	coord(int i, int j) { x = i; y = j; }
	void get_xy() { cout << "X: " << x << "Y: " << y << endl; }
	coord operator+(coord ob2);
	coord operator-(coord ob2); 
};

coord coord::operator+(coord ob2) {
	coord temp;
	temp.x = x + ob2.x;
	temp.y = y + ob2.y;
	return temp;
}

coord coord::operator-(coord ob2) {
	coord temp;
	temp.x = x - ob2.x;
	temp.y = y - ob2.y;
	return temp;
}

int main()
{
	coord a(100, 200), b(50, 70), c, d;

	c = a + b;
	d = a - b;
	c.get_xy();
	d.get_xy();

	return 0;
}
```
![[Pasted image 20240424203115.png]]

Давай разберем эту программу по пунктам:

1. Объявление заголовочного файла `<iostream>` позволяет использовать стандартные потоки ввода-вывода C++.

2. Использование директивы `using namespace std;` позволяет использовать идентификаторы из стандартного пространства имен `std` без явного указания префикса `std::`.

3. Объявление класса `coord` с закрытыми данными `x` и `y`, представляющими координаты точки.

4. В классе `coord` есть два конструктора: один без аргументов, который устанавливает обе координаты в 0, и один с двумя аргументами, который инициализирует координаты значениями, переданными в аргументах.

5. Метод `get_xy()` выводит значения координат объекта на экран.

6. Перегруженные операторы `+` и `-` позволяют складывать и вычитать объекты класса `coord`.

7. Метод `operator+` складывает координаты двух объектов и возвращает новый объект `coord`, содержащий результат сложения.

8. Метод `operator-` вычитает координаты одного объекта из координат другого объекта и возвращает новый объект `coord`, содержащий результат вычитания.

9. В функции `main()` создаются два объекта класса `coord`: `a` с координатами (100, 200) и `b` с координатами (50, 70).

10. С помощью операторов `+` и `-` выполняются операции сложения и вычитания соответственно между объектами `a` и `b`, результаты записываются в объекты `c` и `d`.

11. Выводятся на экран значения координат объектов `c` и `d` с помощью метода `get_xy()`.

Наши функции `operator+` и `operator-` возвращают объект типа `coord`. Внутри каждый из операторов производит вычисление координат: к текущим координатам `x` и `y` добавляются координаты `x` и `y` второго объекта (`ob2`) и все это помещается в объект `temp`, который и возвращается оператором.

Затем возвращенные объекты присваиваются соответствующим переменным типа `coord`, в нашем случае это переменные `c` и `d`.

По сути эти две функции:
```cpp
coord coord::operator+(coord ob2) {
    coord temp;
    temp.x = x + ob2.x;
    temp.y = y + ob2.y;
    return temp;
}

coord coord::operator-(coord ob2) {
    coord temp;
    temp.x = x - ob2.x;
    temp.y = y - ob2.y;
    return temp;
}
```

Задают НОВЫЕ ПРАВИЛА СЛОЖЕНИЯ И ВЫЧИТАНИЯ между объектами этого класса. Таким образом, благодаря перегрузке операторов, я могу создавать новые правила для работы с моими пользовательскими типами данных, делая их более интуитивно понятными и удобными в использовании.

Я также попробовал добавить новую перегрузку оператора `*`:
В описание класса я добавил:

```cpp
coord operator*(coord ob2);
```

А также я добавил новую функцию:

```cpp
coord coord::operator*(coord ob2) {
    coord temp;
    temp.x = x * ob2.x;
    temp.y = y * ob2.y;
    return temp;
}
```

И ПОЛУЧИЛОСЬ ВОТ ЭТО:
![[Pasted image 20240424204917.png]]АААААА, а теперь разберем моменты, которые мне не понятны в данный момент. Вот почему в функции перегрузки операторов, например:
```cpp
temp.x = x * ob2.x;
temp.y = y * ob2.y;
```

Откуда компилятор понимает, что такое `x` я вот вообще не понимаю. А вот и ответ:

Когда вы перегружаете операторы для класса, переменные `x` и `y` внутри функций перегрузки операторов `operator+` и `operator-` представляют соответствующие члены данных объекта, для которого была вызвана операция.

Для лучшего понимания, давайте посмотрим на пример:

```cpp
coord coord::operator+(coord ob2) {
    coord temp;
    temp.x = x + ob2.x;
    temp.y = y + ob2.y;
    return temp;
}
```

Здесь `x` и `y` представляют координаты объекта, для которого был вызван оператор `+`, а `ob2.x` и `ob2.y` представляют координаты второго объекта, переданного в качестве аргумента функции.

Когда вы вызываете этот оператор:

```cpp
c = a + b;
```

`a` и `b` - это объекты класса `coord`. При выполнении операции `a + b`, `a` является объектом, для которого вызывается оператор `+`, и его координаты используются вместе с координатами объекта `b`, переданного в качестве аргумента `ob2`, чтобы выполнить операцию сложения. ААААААА ЭТО ИМБА!!!